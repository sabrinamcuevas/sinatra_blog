require 'spec_helper'

RSpec.describe ArticlesController, type: :request do
  include Rack::Test::Methods

  def app
    App.new
  end

  context 'POST #create' do
    let!(:section) { create(:section) }
    it 'when data is sent' do
      VCR.use_cassette('api_article_create') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { introduction: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 title: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 body: {"en":"<p> Many times we wonder <strong>how we can save if the prices of products and services rise too fast</strong> and at a <strong>faster</strong> rate than wages. If you think that it is not worth saving, and you are one of the many people who face this problem, take a few minutes and pay attention to these three strategies of how to take care of your savings in inflation time. </p><h3> How to save in a country with high inflation rates? </h3><p> Although it is not necessary, we clarify the saving methods that do not work in times of inflation: </p><p> <strong>1. Keeping money in cash is not recommended,</strong> since a minimum inflation, will eat your savings. </p><p> <strong>2. Keep the money in banks is not a good idea,</strong> when inflation is higher than the interest paid by the bank to keep your money with them. </p><p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\"></p><h3> If it is not advisable to have cash (\"below the mattress\"), or deposited in banks, where can you save your savings? How to beat inflation? </h3><p> <strong>Method # 1</strong> </p><p> Invest your savings in gold, metals, or jewelry. </p><p> In times of crisis, gold, silver and other metals are considered a good investment, since their value does not depend on the situation in your country, but on the global situation. </p><p> Disadvantage: If after a while you want to recover your savings immediately, it can be difficult to sell at a good price. Also, being physical goods these could be stolen or lost. Therefore, it is not advisable to save much of your savings in this way. </p><p> <strong>Method # 2</strong> </p><p> Save the savings in a stable foreign currency. </p><p> If your country's currency quickly loses its value, you can keep your money in a more stable foreign currency. For example, buy dollars, and convert them to your currency only when you need to use your savings. </p><p> Disadvantage: in times of medium or high inflation, it can be difficult to find a good exchange rate. In addition, today, the spread between buying and selling currencies is huge, so if your savings is planned in the short term this alternative is only good business for banks and exchange houses. </p><p> <strong>Method # 3</strong> </p><p> Invest your savings in assets. </p><p> The best thing is to invest your money in projects that involve movable or immovable property, and that their returns exceed inflation. </p><p> But, realistically, we know that many of us can not buy something as expensive as a house, a truck, a yacht or a lot of ATMs, an ultrasound machine or vending machines. So how can I do to invest? <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">In SeSocio.com different investment projects are published</a> , and if among all the investors it is possible to obtain the necessary financing amount, SeSocio I Trust, managed by BLC TRUST SA (Financial Trustee N ° 63 Registered in CNV), will perfect the operation in name and representation of the investors who decided to participate in the project. Published projects offer fixed, variable or mixed interest rates. You can also find projects where the gain depends on the revaluation of the property, as in the case of real estate. </p><p> Also, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provides a trading platform in which you can sell your shares or tokens in a project directly to another investor. In other words, you can keep your money moving without losing purchasing power, and once you sell your shares, you can invest it in another project of your interest. </p><p> <strong>Disadvantage:</strong> It is so easy to be part of the investment community of SeSocio, that it will be difficult for you not to enter <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> every day to see the new projects available and the news of the projects in which you have already invested; Above is 100% online! </p><p><br></p>", "es":"<p>Muchas veces nos preguntamos <strong>cómo podemos ahorrar si los precios de los productos y servicios suben demasiado rápido</strong> y a un ritmo superior que los salarios. Si pensás que no vale la pena ahorrar, y sos una de las tantas personas que se enfrentan a esta problemática, tomate unos minutos y prestá atención a estas tres estrategias de cómo cuidar de tus ahorros en tiempo de inflación.</p>\r\n\r\n<h3>¿Cómo ahorrar en un país con elevadísimas tasas de inflación?</h3>\r\n\r\n<p>Si bien no hace falta, aclaramos los métodos de ahorro que no funcionan en tiempos de inflación:</p>\r\n\r\n<p><strong>1. Guardar el dinero en efectivo no es recomendable,</strong> ya que una mínima inflación, va a comer tus ahorros.</p>\r\n\r\n<p><strong>2. Guardar el dinero en los bancos tampoco es buena idea,</strong> cuando la inflación es más alta que los intereses que te paga el banco por guardar con ellos tu dinero.</p>\r\n\r\n<p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\" /></p>\r\n\r\n<h3>Si no es recomendable tener dinero en efectivo (“abajo del colchón”), ni depositados en bancos ¿Dónde puedes guardar tu ahorro? ¿Cómo ganarle a la inflación?</h3>\r\n\r\n<p><strong>Método #1</strong></p>\r\n\r\n<p>Invertir tus ahorros en oro, metales, o joyería.</p>\r\n\r\n<p>En el tiempo de crisis, el oro, la plata y otros metales están considerados como una buena inversión, ya que su valor no depende de la situación en tu país, sino de la situación global.</p>\r\n\r\n<p>Desventaja: Si después de un tiempo quieres recuperar tus ahorros de inmediato, puede ser difícil venderlo a buen precio. Además, al ser bienes físicos estos podrían ser sustraídos o extraviados. Por lo tanto, no es recomendable guardar gran parte de tus ahorros en esta forma.</p>\r\n\r\n<p><strong>Método #2</strong></p>\r\n\r\n<p>Guardar el ahorro en una moneda extranjera estable.</p>\r\n\r\n<p>Si la moneda de tu país pierde rápido su valor, puedes mantener tu dinero en una moneda extranjera más estable. Por ejemplo, comprar dólares, y los conviertes a tu moneda solamente cuando necesitas hacer uso de tus ahorros.</p>\r\n\r\n<p>Desventaja: en tiempos de una media o alta inflación, puede ser difícil, encontrar una buena tasa de cambio. Además, hoy en día, el spread entre la compra y venta de divisas es enorme, por lo que si tu ahorro está planificado a corto plazo esta alternativa solo es un buen negocio para los bancos y casas de cambio.</p>\r\n\r\n<p><strong>Método #3</strong></p>\r\n\r\n<p>Invertir tus ahorros en bienes.</p>\r\n\r\n<p>Lo mejor es invertir tu dinero en proyectos que involucren bienes muebles o inmuebles, y que sus retornos superen a la inflación.</p>\r\n\r\n<p>Pero, siendo realistas, sabemos que muchos de nosotros no podemos comprar algo tan caro como una casa, un camión, un yate o un lote de cajeros automáticos, un ecógrafo o máquinas expendedoras. ¿Entonces cómo puedo hacer para invertir?<a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\"> En SeSocio.com se publican distintos proyectos de inversión</a>, y si entre todos los inversores se logra obtener el monto necesario de financiamiento el Fideicomiso SeSocio I, administrado por BLC TRUST S.A. (Fiduciario Financiero Nº 63 Registrado en CNV), perfeccionará la operación en nombre y representación de los inversores que decidieron participar del proyecto. Los proyectos publicados ofrecen tasas de interés fijas, variables o mixtas. También podrás encontrar proyectos donde la ganancia depende de la revalorización del bien, como es el caso de los inmuebles.</p>\r\n\r\n<p>Asimismo, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provee una plataforma de trading en la cual podrás vender tus participaciones o tokens en un proyecto en forma directa a otro inversor. En otras palabras, podrás mantener tu dinero en movimiento sin perder poder adquisitivo, y una vez que vendas tus participaciones, podrás invertirlo en otro proyecto de tu interés.</p>\r\n\r\n<p><strong>Desventaja:</strong> Es tan fácil ser parte de la comunidad de inversores de SeSocio, que te va a resultar difícil no entrar todos los días a <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> a ver los nuevos proyectos disponibles y las novedades de los proyectos en los que ya invertiste; ¡Encima es 100% online! </p>\r\n\r\n<p> </p>\r\n"}.to_json,
                 difficulty_level: 1,
                 section_id: section.id,
                 published_at: Time.now,
                 tag_ids: [8, 9, 10, 12],
                 short_description: Faker::Lorem.paragraph,
                 article_title_id: {"es":"como-ahorrar-en-tiempos-de-inflación?"}.to_json,
                 file: 'data:image/png;base64,' + Base64.encode64(File.open('spec/fixtures/article.png', 'rb').read) 
              }
        response = post 'sscool/v1/article', data
        expect(JSON.parse(response.body)['status']).to eq('ok')
      end
    end

    it 'when some mandatory items are not shipped' do
      VCR.use_cassette('api_article_create_2') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { introduction: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 title: '',
                 section_id: section.id,
                 body: '',
                 difficulty_level: 1,
                 published_at: Time.now }
        response = post 'sscool/v1/article', data
        expect(JSON.parse(response.body)['status']).to eq('unprocessable_entity')
      end
    end

    it 'when the section is not sent or does not exist' do
      VCR.use_cassette('api_article_create_2') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { introduction: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 title: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 body: {"en":"<p> Many times we wonder <strong>how we can save if the prices of products and services rise too fast</strong> and at a <strong>faster</strong> rate than wages. If you think that it is not worth saving, and you are one of the many people who face this problem, take a few minutes and pay attention to these three strategies of how to take care of your savings in inflation time. </p><h3> How to save in a country with high inflation rates? </h3><p> Although it is not necessary, we clarify the saving methods that do not work in times of inflation: </p><p> <strong>1. Keeping money in cash is not recommended,</strong> since a minimum inflation, will eat your savings. </p><p> <strong>2. Keep the money in banks is not a good idea,</strong> when inflation is higher than the interest paid by the bank to keep your money with them. </p><p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\"></p><h3> If it is not advisable to have cash (\"below the mattress\"), or deposited in banks, where can you save your savings? How to beat inflation? </h3><p> <strong>Method # 1</strong> </p><p> Invest your savings in gold, metals, or jewelry. </p><p> In times of crisis, gold, silver and other metals are considered a good investment, since their value does not depend on the situation in your country, but on the global situation. </p><p> Disadvantage: If after a while you want to recover your savings immediately, it can be difficult to sell at a good price. Also, being physical goods these could be stolen or lost. Therefore, it is not advisable to save much of your savings in this way. </p><p> <strong>Method # 2</strong> </p><p> Save the savings in a stable foreign currency. </p><p> If your country's currency quickly loses its value, you can keep your money in a more stable foreign currency. For example, buy dollars, and convert them to your currency only when you need to use your savings. </p><p> Disadvantage: in times of medium or high inflation, it can be difficult to find a good exchange rate. In addition, today, the spread between buying and selling currencies is huge, so if your savings is planned in the short term this alternative is only good business for banks and exchange houses. </p><p> <strong>Method # 3</strong> </p><p> Invest your savings in assets. </p><p> The best thing is to invest your money in projects that involve movable or immovable property, and that their returns exceed inflation. </p><p> But, realistically, we know that many of us can not buy something as expensive as a house, a truck, a yacht or a lot of ATMs, an ultrasound machine or vending machines. So how can I do to invest? <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">In SeSocio.com different investment projects are published</a> , and if among all the investors it is possible to obtain the necessary financing amount, SeSocio I Trust, managed by BLC TRUST SA (Financial Trustee N ° 63 Registered in CNV), will perfect the operation in name and representation of the investors who decided to participate in the project. Published projects offer fixed, variable or mixed interest rates. You can also find projects where the gain depends on the revaluation of the property, as in the case of real estate. </p><p> Also, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provides a trading platform in which you can sell your shares or tokens in a project directly to another investor. In other words, you can keep your money moving without losing purchasing power, and once you sell your shares, you can invest it in another project of your interest. </p><p> <strong>Disadvantage:</strong> It is so easy to be part of the investment community of SeSocio, that it will be difficult for you not to enter <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> every day to see the new projects available and the news of the projects in which you have already invested; Above is 100% online! </p><p><br></p>", "es":"<p>Muchas veces nos preguntamos <strong>cómo podemos ahorrar si los precios de los productos y servicios suben demasiado rápido</strong> y a un ritmo superior que los salarios. Si pensás que no vale la pena ahorrar, y sos una de las tantas personas que se enfrentan a esta problemática, tomate unos minutos y prestá atención a estas tres estrategias de cómo cuidar de tus ahorros en tiempo de inflación.</p>\r\n\r\n<h3>¿Cómo ahorrar en un país con elevadísimas tasas de inflación?</h3>\r\n\r\n<p>Si bien no hace falta, aclaramos los métodos de ahorro que no funcionan en tiempos de inflación:</p>\r\n\r\n<p><strong>1. Guardar el dinero en efectivo no es recomendable,</strong> ya que una mínima inflación, va a comer tus ahorros.</p>\r\n\r\n<p><strong>2. Guardar el dinero en los bancos tampoco es buena idea,</strong> cuando la inflación es más alta que los intereses que te paga el banco por guardar con ellos tu dinero.</p>\r\n\r\n<p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\" /></p>\r\n\r\n<h3>Si no es recomendable tener dinero en efectivo (“abajo del colchón”), ni depositados en bancos ¿Dónde puedes guardar tu ahorro? ¿Cómo ganarle a la inflación?</h3>\r\n\r\n<p><strong>Método #1</strong></p>\r\n\r\n<p>Invertir tus ahorros en oro, metales, o joyería.</p>\r\n\r\n<p>En el tiempo de crisis, el oro, la plata y otros metales están considerados como una buena inversión, ya que su valor no depende de la situación en tu país, sino de la situación global.</p>\r\n\r\n<p>Desventaja: Si después de un tiempo quieres recuperar tus ahorros de inmediato, puede ser difícil venderlo a buen precio. Además, al ser bienes físicos estos podrían ser sustraídos o extraviados. Por lo tanto, no es recomendable guardar gran parte de tus ahorros en esta forma.</p>\r\n\r\n<p><strong>Método #2</strong></p>\r\n\r\n<p>Guardar el ahorro en una moneda extranjera estable.</p>\r\n\r\n<p>Si la moneda de tu país pierde rápido su valor, puedes mantener tu dinero en una moneda extranjera más estable. Por ejemplo, comprar dólares, y los conviertes a tu moneda solamente cuando necesitas hacer uso de tus ahorros.</p>\r\n\r\n<p>Desventaja: en tiempos de una media o alta inflación, puede ser difícil, encontrar una buena tasa de cambio. Además, hoy en día, el spread entre la compra y venta de divisas es enorme, por lo que si tu ahorro está planificado a corto plazo esta alternativa solo es un buen negocio para los bancos y casas de cambio.</p>\r\n\r\n<p><strong>Método #3</strong></p>\r\n\r\n<p>Invertir tus ahorros en bienes.</p>\r\n\r\n<p>Lo mejor es invertir tu dinero en proyectos que involucren bienes muebles o inmuebles, y que sus retornos superen a la inflación.</p>\r\n\r\n<p>Pero, siendo realistas, sabemos que muchos de nosotros no podemos comprar algo tan caro como una casa, un camión, un yate o un lote de cajeros automáticos, un ecógrafo o máquinas expendedoras. ¿Entonces cómo puedo hacer para invertir?<a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\"> En SeSocio.com se publican distintos proyectos de inversión</a>, y si entre todos los inversores se logra obtener el monto necesario de financiamiento el Fideicomiso SeSocio I, administrado por BLC TRUST S.A. (Fiduciario Financiero Nº 63 Registrado en CNV), perfeccionará la operación en nombre y representación de los inversores que decidieron participar del proyecto. Los proyectos publicados ofrecen tasas de interés fijas, variables o mixtas. También podrás encontrar proyectos donde la ganancia depende de la revalorización del bien, como es el caso de los inmuebles.</p>\r\n\r\n<p>Asimismo, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provee una plataforma de trading en la cual podrás vender tus participaciones o tokens en un proyecto en forma directa a otro inversor. En otras palabras, podrás mantener tu dinero en movimiento sin perder poder adquisitivo, y una vez que vendas tus participaciones, podrás invertirlo en otro proyecto de tu interés.</p>\r\n\r\n<p><strong>Desventaja:</strong> Es tan fácil ser parte de la comunidad de inversores de SeSocio, que te va a resultar difícil no entrar todos los días a <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> a ver los nuevos proyectos disponibles y las novedades de los proyectos en los que ya invertiste; ¡Encima es 100% online! </p>\r\n\r\n<p> </p>\r\n"}.to_json,
                 difficulty_level: 1,
                 section_id: section.id + 2322,
                 published_at: Time.now,
                 tag_ids: [8, 9, 10, 12],
                 short_description: Faker::Lorem.paragraph,
                 article_title_id: {"es":"como-ahorrar-en-tiempos-de-inflación?"}.to_json,
                 file: 'data:image/png;base64,' + Base64.encode64(File.open('spec/fixtures/article.png', 'rb').read) }
        response = post 'sscool/v1/article', data
        expect(JSON.parse(response.body)['status']).to eq('not_found')
      end
    end
  end

  context 'PUT #update' do
    let!(:section) { create(:section) }
    let!(:articles_cafe) { create(:cafe_crypto) }
    it 'when data is sent' do
      VCR.use_cassette('api_article_update') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { id: articles_cafe.id,
                 introduction: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 title: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 body: {"en":"<p> Many times we wonder <strong>how we can save if the prices of products and services rise too fast</strong> and at a <strong>faster</strong> rate than wages. If you think that it is not worth saving, and you are one of the many people who face this problem, take a few minutes and pay attention to these three strategies of how to take care of your savings in inflation time. </p><h3> How to save in a country with high inflation rates? </h3><p> Although it is not necessary, we clarify the saving methods that do not work in times of inflation: </p><p> <strong>1. Keeping money in cash is not recommended,</strong> since a minimum inflation, will eat your savings. </p><p> <strong>2. Keep the money in banks is not a good idea,</strong> when inflation is higher than the interest paid by the bank to keep your money with them. </p><p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\"></p><h3> If it is not advisable to have cash (\"below the mattress\"), or deposited in banks, where can you save your savings? How to beat inflation? </h3><p> <strong>Method # 1</strong> </p><p> Invest your savings in gold, metals, or jewelry. </p><p> In times of crisis, gold, silver and other metals are considered a good investment, since their value does not depend on the situation in your country, but on the global situation. </p><p> Disadvantage: If after a while you want to recover your savings immediately, it can be difficult to sell at a good price. Also, being physical goods these could be stolen or lost. Therefore, it is not advisable to save much of your savings in this way. </p><p> <strong>Method # 2</strong> </p><p> Save the savings in a stable foreign currency. </p><p> If your country's currency quickly loses its value, you can keep your money in a more stable foreign currency. For example, buy dollars, and convert them to your currency only when you need to use your savings. </p><p> Disadvantage: in times of medium or high inflation, it can be difficult to find a good exchange rate. In addition, today, the spread between buying and selling currencies is huge, so if your savings is planned in the short term this alternative is only good business for banks and exchange houses. </p><p> <strong>Method # 3</strong> </p><p> Invest your savings in assets. </p><p> The best thing is to invest your money in projects that involve movable or immovable property, and that their returns exceed inflation. </p><p> But, realistically, we know that many of us can not buy something as expensive as a house, a truck, a yacht or a lot of ATMs, an ultrasound machine or vending machines. So how can I do to invest? <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">In SeSocio.com different investment projects are published</a> , and if among all the investors it is possible to obtain the necessary financing amount, SeSocio I Trust, managed by BLC TRUST SA (Financial Trustee N ° 63 Registered in CNV), will perfect the operation in name and representation of the investors who decided to participate in the project. Published projects offer fixed, variable or mixed interest rates. You can also find projects where the gain depends on the revaluation of the property, as in the case of real estate. </p><p> Also, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provides a trading platform in which you can sell your shares or tokens in a project directly to another investor. In other words, you can keep your money moving without losing purchasing power, and once you sell your shares, you can invest it in another project of your interest. </p><p> <strong>Disadvantage:</strong> It is so easy to be part of the investment community of SeSocio, that it will be difficult for you not to enter <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> every day to see the new projects available and the news of the projects in which you have already invested; Above is 100% online! </p><p><br></p>", "es":"<p>Muchas veces nos preguntamos <strong>cómo podemos ahorrar si los precios de los productos y servicios suben demasiado rápido</strong> y a un ritmo superior que los salarios. Si pensás que no vale la pena ahorrar, y sos una de las tantas personas que se enfrentan a esta problemática, tomate unos minutos y prestá atención a estas tres estrategias de cómo cuidar de tus ahorros en tiempo de inflación.</p>\r\n\r\n<h3>¿Cómo ahorrar en un país con elevadísimas tasas de inflación?</h3>\r\n\r\n<p>Si bien no hace falta, aclaramos los métodos de ahorro que no funcionan en tiempos de inflación:</p>\r\n\r\n<p><strong>1. Guardar el dinero en efectivo no es recomendable,</strong> ya que una mínima inflación, va a comer tus ahorros.</p>\r\n\r\n<p><strong>2. Guardar el dinero en los bancos tampoco es buena idea,</strong> cuando la inflación es más alta que los intereses que te paga el banco por guardar con ellos tu dinero.</p>\r\n\r\n<p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\" /></p>\r\n\r\n<h3>Si no es recomendable tener dinero en efectivo (“abajo del colchón”), ni depositados en bancos ¿Dónde puedes guardar tu ahorro? ¿Cómo ganarle a la inflación?</h3>\r\n\r\n<p><strong>Método #1</strong></p>\r\n\r\n<p>Invertir tus ahorros en oro, metales, o joyería.</p>\r\n\r\n<p>En el tiempo de crisis, el oro, la plata y otros metales están considerados como una buena inversión, ya que su valor no depende de la situación en tu país, sino de la situación global.</p>\r\n\r\n<p>Desventaja: Si después de un tiempo quieres recuperar tus ahorros de inmediato, puede ser difícil venderlo a buen precio. Además, al ser bienes físicos estos podrían ser sustraídos o extraviados. Por lo tanto, no es recomendable guardar gran parte de tus ahorros en esta forma.</p>\r\n\r\n<p><strong>Método #2</strong></p>\r\n\r\n<p>Guardar el ahorro en una moneda extranjera estable.</p>\r\n\r\n<p>Si la moneda de tu país pierde rápido su valor, puedes mantener tu dinero en una moneda extranjera más estable. Por ejemplo, comprar dólares, y los conviertes a tu moneda solamente cuando necesitas hacer uso de tus ahorros.</p>\r\n\r\n<p>Desventaja: en tiempos de una media o alta inflación, puede ser difícil, encontrar una buena tasa de cambio. Además, hoy en día, el spread entre la compra y venta de divisas es enorme, por lo que si tu ahorro está planificado a corto plazo esta alternativa solo es un buen negocio para los bancos y casas de cambio.</p>\r\n\r\n<p><strong>Método #3</strong></p>\r\n\r\n<p>Invertir tus ahorros en bienes.</p>\r\n\r\n<p>Lo mejor es invertir tu dinero en proyectos que involucren bienes muebles o inmuebles, y que sus retornos superen a la inflación.</p>\r\n\r\n<p>Pero, siendo realistas, sabemos que muchos de nosotros no podemos comprar algo tan caro como una casa, un camión, un yate o un lote de cajeros automáticos, un ecógrafo o máquinas expendedoras. ¿Entonces cómo puedo hacer para invertir?<a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\"> En SeSocio.com se publican distintos proyectos de inversión</a>, y si entre todos los inversores se logra obtener el monto necesario de financiamiento el Fideicomiso SeSocio I, administrado por BLC TRUST S.A. (Fiduciario Financiero Nº 63 Registrado en CNV), perfeccionará la operación en nombre y representación de los inversores que decidieron participar del proyecto. Los proyectos publicados ofrecen tasas de interés fijas, variables o mixtas. También podrás encontrar proyectos donde la ganancia depende de la revalorización del bien, como es el caso de los inmuebles.</p>\r\n\r\n<p>Asimismo, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provee una plataforma de trading en la cual podrás vender tus participaciones o tokens en un proyecto en forma directa a otro inversor. En otras palabras, podrás mantener tu dinero en movimiento sin perder poder adquisitivo, y una vez que vendas tus participaciones, podrás invertirlo en otro proyecto de tu interés.</p>\r\n\r\n<p><strong>Desventaja:</strong> Es tan fácil ser parte de la comunidad de inversores de SeSocio, que te va a resultar difícil no entrar todos los días a <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> a ver los nuevos proyectos disponibles y las novedades de los proyectos en los que ya invertiste; ¡Encima es 100% online! </p>\r\n\r\n<p> </p>\r\n"}.to_json,
                 difficulty_level: 1,
                 section_id: section.id,
                 published_at: Time.now,
                 tag_ids: [8, 9, 10, 12],
                 short_description: Faker::Lorem.paragraph,
                 article_title_id: {"es":"como-ahorrar-en-tiempos-de-inflación?"}.to_json,
                 file: 'data:image/png;base64,' + Base64.encode64(File.open('spec/fixtures/article.png', 'rb').read) 
                }
        response = put 'sscool/v1/article', data
        expect(JSON.parse(response.body)['status']).to eq('ok')
      end
    end

    it 'when some items are not shipped' do
      VCR.use_cassette('api_article_update_2') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { id: articles_cafe.id,
                 introduction: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 title: '',
                 body: '',
                 difficulty_level: 1,
                 section_id: section.id,
                 published_at: Time.now }
        response = put 'sscool/v1/article', data
        expect(JSON.parse(response.body)['status']).to eq('unprocessable_entity')
      end
    end

    it 'when id article no exits' do
      VCR.use_cassette('api_article_update_2') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { id: 788_777,
                 introduction: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 title: {"en":"How to save in times of inflation?", "es":"¿Cómo ahorrar en tiempos de Inflación? "}.to_json,
                 body: {"en":"<p> Many times we wonder <strong>how we can save if the prices of products and services rise too fast</strong> and at a <strong>faster</strong> rate than wages. If you think that it is not worth saving, and you are one of the many people who face this problem, take a few minutes and pay attention to these three strategies of how to take care of your savings in inflation time. </p><h3> How to save in a country with high inflation rates? </h3><p> Although it is not necessary, we clarify the saving methods that do not work in times of inflation: </p><p> <strong>1. Keeping money in cash is not recommended,</strong> since a minimum inflation, will eat your savings. </p><p> <strong>2. Keep the money in banks is not a good idea,</strong> when inflation is higher than the interest paid by the bank to keep your money with them. </p><p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\"></p><h3> If it is not advisable to have cash (\"below the mattress\"), or deposited in banks, where can you save your savings? How to beat inflation? </h3><p> <strong>Method # 1</strong> </p><p> Invest your savings in gold, metals, or jewelry. </p><p> In times of crisis, gold, silver and other metals are considered a good investment, since their value does not depend on the situation in your country, but on the global situation. </p><p> Disadvantage: If after a while you want to recover your savings immediately, it can be difficult to sell at a good price. Also, being physical goods these could be stolen or lost. Therefore, it is not advisable to save much of your savings in this way. </p><p> <strong>Method # 2</strong> </p><p> Save the savings in a stable foreign currency. </p><p> If your country's currency quickly loses its value, you can keep your money in a more stable foreign currency. For example, buy dollars, and convert them to your currency only when you need to use your savings. </p><p> Disadvantage: in times of medium or high inflation, it can be difficult to find a good exchange rate. In addition, today, the spread between buying and selling currencies is huge, so if your savings is planned in the short term this alternative is only good business for banks and exchange houses. </p><p> <strong>Method # 3</strong> </p><p> Invest your savings in assets. </p><p> The best thing is to invest your money in projects that involve movable or immovable property, and that their returns exceed inflation. </p><p> But, realistically, we know that many of us can not buy something as expensive as a house, a truck, a yacht or a lot of ATMs, an ultrasound machine or vending machines. So how can I do to invest? <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">In SeSocio.com different investment projects are published</a> , and if among all the investors it is possible to obtain the necessary financing amount, SeSocio I Trust, managed by BLC TRUST SA (Financial Trustee N ° 63 Registered in CNV), will perfect the operation in name and representation of the investors who decided to participate in the project. Published projects offer fixed, variable or mixed interest rates. You can also find projects where the gain depends on the revaluation of the property, as in the case of real estate. </p><p> Also, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provides a trading platform in which you can sell your shares or tokens in a project directly to another investor. In other words, you can keep your money moving without losing purchasing power, and once you sell your shares, you can invest it in another project of your interest. </p><p> <strong>Disadvantage:</strong> It is so easy to be part of the investment community of SeSocio, that it will be difficult for you not to enter <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> every day to see the new projects available and the news of the projects in which you have already invested; Above is 100% online! </p><p><br></p>", "es":"<p>Muchas veces nos preguntamos <strong>cómo podemos ahorrar si los precios de los productos y servicios suben demasiado rápido</strong> y a un ritmo superior que los salarios. Si pensás que no vale la pena ahorrar, y sos una de las tantas personas que se enfrentan a esta problemática, tomate unos minutos y prestá atención a estas tres estrategias de cómo cuidar de tus ahorros en tiempo de inflación.</p>\r\n\r\n<h3>¿Cómo ahorrar en un país con elevadísimas tasas de inflación?</h3>\r\n\r\n<p>Si bien no hace falta, aclaramos los métodos de ahorro que no funcionan en tiempos de inflación:</p>\r\n\r\n<p><strong>1. Guardar el dinero en efectivo no es recomendable,</strong> ya que una mínima inflación, va a comer tus ahorros.</p>\r\n\r\n<p><strong>2. Guardar el dinero en los bancos tampoco es buena idea,</strong> cuando la inflación es más alta que los intereses que te paga el banco por guardar con ellos tu dinero.</p>\r\n\r\n<p><img alt=\"\" class=\"img-responsive\" src=\"https://sesocio.s3.amazonaws.com/assets/article_photos/photos/000/000/631/medium/c954dd5a7d885d0ebfff1f24f644237e1bd4e249.jpeg?1552400044\" /></p>\r\n\r\n<h3>Si no es recomendable tener dinero en efectivo (“abajo del colchón”), ni depositados en bancos ¿Dónde puedes guardar tu ahorro? ¿Cómo ganarle a la inflación?</h3>\r\n\r\n<p><strong>Método #1</strong></p>\r\n\r\n<p>Invertir tus ahorros en oro, metales, o joyería.</p>\r\n\r\n<p>En el tiempo de crisis, el oro, la plata y otros metales están considerados como una buena inversión, ya que su valor no depende de la situación en tu país, sino de la situación global.</p>\r\n\r\n<p>Desventaja: Si después de un tiempo quieres recuperar tus ahorros de inmediato, puede ser difícil venderlo a buen precio. Además, al ser bienes físicos estos podrían ser sustraídos o extraviados. Por lo tanto, no es recomendable guardar gran parte de tus ahorros en esta forma.</p>\r\n\r\n<p><strong>Método #2</strong></p>\r\n\r\n<p>Guardar el ahorro en una moneda extranjera estable.</p>\r\n\r\n<p>Si la moneda de tu país pierde rápido su valor, puedes mantener tu dinero en una moneda extranjera más estable. Por ejemplo, comprar dólares, y los conviertes a tu moneda solamente cuando necesitas hacer uso de tus ahorros.</p>\r\n\r\n<p>Desventaja: en tiempos de una media o alta inflación, puede ser difícil, encontrar una buena tasa de cambio. Además, hoy en día, el spread entre la compra y venta de divisas es enorme, por lo que si tu ahorro está planificado a corto plazo esta alternativa solo es un buen negocio para los bancos y casas de cambio.</p>\r\n\r\n<p><strong>Método #3</strong></p>\r\n\r\n<p>Invertir tus ahorros en bienes.</p>\r\n\r\n<p>Lo mejor es invertir tu dinero en proyectos que involucren bienes muebles o inmuebles, y que sus retornos superen a la inflación.</p>\r\n\r\n<p>Pero, siendo realistas, sabemos que muchos de nosotros no podemos comprar algo tan caro como una casa, un camión, un yate o un lote de cajeros automáticos, un ecógrafo o máquinas expendedoras. ¿Entonces cómo puedo hacer para invertir?<a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\"> En SeSocio.com se publican distintos proyectos de inversión</a>, y si entre todos los inversores se logra obtener el monto necesario de financiamiento el Fideicomiso SeSocio I, administrado por BLC TRUST S.A. (Fiduciario Financiero Nº 63 Registrado en CNV), perfeccionará la operación en nombre y representación de los inversores que decidieron participar del proyecto. Los proyectos publicados ofrecen tasas de interés fijas, variables o mixtas. También podrás encontrar proyectos donde la ganancia depende de la revalorización del bien, como es el caso de los inmuebles.</p>\r\n\r\n<p>Asimismo, <a href=\"https://www.sesocio.com/projects\" rel=\"noopener noreferrer\" target=\"_blank\">SeSocio.com</a> provee una plataforma de trading en la cual podrás vender tus participaciones o tokens en un proyecto en forma directa a otro inversor. En otras palabras, podrás mantener tu dinero en movimiento sin perder poder adquisitivo, y una vez que vendas tus participaciones, podrás invertirlo en otro proyecto de tu interés.</p>\r\n\r\n<p><strong>Desventaja:</strong> Es tan fácil ser parte de la comunidad de inversores de SeSocio, que te va a resultar difícil no entrar todos los días a <a href=\"http://sesocio.com/\" target=\"_blank\">Sesocio.com</a> a ver los nuevos proyectos disponibles y las novedades de los proyectos en los que ya invertiste; ¡Encima es 100% online! </p>\r\n\r\n<p> </p>\r\n"}.to_json,
                 difficulty_level: 1,
                 section_id: section.id,
                 published_at: Time.now,
                 tag_ids: [8, 9, 10, 12],
                 short_description: Faker::Lorem.paragraph,
                 article_title_id: {"es":"como-ahorrar-en-tiempos-de-inflación?"}.to_json }
        response = put 'sscool/v1/article', data
        expect(JSON.parse(response.body)['status']).to eq('not_found')
      end
    end
  end

  context 'DELETE #destroy' do
    let!(:articles_cafe) { create(:cafe_crypto) }
    it 'when id is sent' do
      VCR.use_cassette('api_article_delete') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        response = delete "sscool/v1/article/#{articles_cafe.id}"
        expect(JSON.parse(response.body)['status']).to eq('ok')
      end
    end

    it 'when id is not found' do
      VCR.use_cassette('api_article_delete_2') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        response = delete 'sscool/v1/article/32_320'
        expect(JSON.parse(response.body)['status']).to eq('not_found')
      end
    end
  end

  context 'GET #articles' do
    let!(:articles_cafe) { create(:cafe_crypto) }
    it 'when type is sent' do
      VCR.use_cassette('api_list_articles') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { 'type' => 'cafe_crypto', 'limit' => 3 }
        response = get 'sscool/v1/article/list', data
        expect(JSON.parse(response.body)['status']).to eq('ok')
      end
    end

    it 'when type is no sent' do
      VCR.use_cassette('api_list_articles_2') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { 'type' => '', 'limit' => 3 }
        response = get 'sscool/v1/article/list', data
        expect(JSON.parse(response.body)['status']).to eq('unprocessable_entity')
      end
    end

    it 'when limit is no sent' do
      VCR.use_cassette('api_list_articles_3') do
        token = JsonWebToken.encode({ user_id: 21, email: 'admin@sesocio.com', role: 'admin' },
                                    Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { 'type' => 'cafe_crypto' }
        response = get 'sscool/v1/article/list', data
        expect(JSON.parse(response.body)['status']).to eq('ok')
      end
    end
  end

  context 'error login' do
    let!(:articles_cafe) { create(:cafe_crypto) }
    it 'when create article' do
      VCR.use_cassette('login_error') do
        token = JsonWebToken.encode({}, Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { title: Faker::Lorem.sentence }
        response = post 'sscool/v1/article', data
        expect(JSON.parse(response.body)['error']).to eq('Error, not logged in')
      end
    end

    it 'when update article' do
      VCR.use_cassette('login_error_update') do
        token = JsonWebToken.encode({}, Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        data = { title: Faker::Lorem.sentence }
        response = put 'sscool/v1/article', data
        expect(JSON.parse(response.body)['error']).to eq('Error, not logged in')
      end
    end

    it 'when delete article' do
      VCR.use_cassette('login_error_delete') do
        token = JsonWebToken.encode({}, Time.now.to_i + 24.hours.to_i)
        header 'authorization', token.to_s
        response = delete "sscool/v1/article/#{articles_cafe.id}"
        expect(JSON.parse(response.body)['error']).to eq('Error, not logged in')
      end
    end
  end
end
